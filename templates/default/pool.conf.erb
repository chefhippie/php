; Generated by Chef for <%= node["fqdn"] %>
[<%= @alias %>]
;prefix = /path/to/pools/$pool

user = <%= @user %>
group = <%= @group %>

listen = <%= @run_dir %>/$pool.socket
listen.owner = <%= @listen_user %>
listen.group = <%= @listen_group %>
listen.mode = 0660

;listen.backlog = -1
;listen.allowed_clients = 127.0.0.1

;priority = -19

pm = dynamic

pm.max_children = 5
pm.start_servers = 3
pm.min_spare_servers = 1
pm.max_spare_servers = 3

;pm.process_idle_timeout = 10s
;pm.max_requests = 500

;pm.status_path = /fpmstat
;ping.path = /fpmping
;ping.response = pong

slowlog = <%= @log_dir %>/$pool.slow.log
access.log = <%= @log_dir %>/$pool.access.log
access.format = "%R - %u %t \"%m %r\" %s"

;request_slowlog_timeout = 0
;request_terminate_timeout = 0

;rlimit_files = 1024
;rlimit_core = 0

;chroot = 
chdir = <%= @chdir %>

;catch_workers_output = yes
;security.limit_extensions = .php .php3 .php4 .php5

env[HOSTNAME] = $HOSTNAME
env[PATH] = /usr/local/bin:/usr/bin:/bin
env[TMP] = /tmp
env[TMPDIR] = /tmp
env[TEMP] = /tmp

php_admin_value[error_log] = <%= @log_dir %>/$pool.error.log

<% @admin_values.each do |key, value| %>
  php_admin_value[<%= key.to_s %>] = <%= value %>
<% end %>
<% @admin_flags.each do |key, value| %>
  php_admin_flag[<%= key.to_s %>] = <%= value ? "on" : "off" %>
<% end %>
<% @php_values.each do |key, value| %>
  php_value[<%= key.to_s %>] = <%= value %>
<% end %>
<% @php_flags.each do |key, value| %>
  php_flag[<%= key.to_s %>] = <%= value ? "on" : "off" %>
<% end %>
